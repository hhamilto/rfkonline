<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Royal Family Kids</title>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="js/underscore-min.js"></script>
        <script src="http://www.parsecdn.com/js/parse-1.1.15.min.js"></script>
        <!-- USE THIS ONE FOR DEBUGGING WHEN YOU WANT TO SEE THE PARSE SOURCE.
             JUST REMEMBER TO RE-COMMENT IT. ALSO, watch out because its up a minor version, and somethings are
             different. for example, in Parse photo objects, url is now a function. 
         script src="https://parse.com/downloads/javascript/parse-1.2.13.js"></script-->
        <script src="js/parsley.js" ></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/moment.min.js"></script>
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
        <script src="js/bootstrap-lightbox.min.js"></script>

        <script src="js/util.js"></script>
        <script src="js/rfk.js"></script>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/bootstrap.css" rel="stylesheet" media="screen">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-lightbox.min.css"/>
        <link rel="stylesheet" type="text/css" href="css/custom.css"/>
        <link rel="icon" href="img/favicon.png" type="image/png" />
        <link rel="shortcut icon" href="favicon.ico" />
    </head>

    <body>

    <div id="mainApp">
        <div class="content">
        </div>
    </div>

    <script type="text/template" id="login-template">
        <header id="header"></header>
        <div class="container">
            <div class="col-md-5 center">
                <form class="form-horizontal loginForm" role="form">
                    <h2 class="text-right" id="loginTitle" style="text-shadow:0px 0px 5px #8A8A8A;">Royal Family Kids Login</h2>
                    <div class="error" style="display:none"></div>
                    <div class="form-group" id="loginFormGroup">
                    <label for="inputEmail" class="col-lg-3 control-label">Email</label>
                    <div class="col-lg-9">
                        <input class="form-control form-control-static" id="inputEmail" placeholder="Email"
                            data-content="Invalid email/password" data-trigger="manual">
                    </div>
                    </div>
                    <div class="form-group">
                    <label for="inputPassword" class="col-lg-3 control-label">Password</label>
                    <div class="col-lg-9">
                        <input type="password" class="form-control" id="inputPassword" placeholder="Password">
                    </div>
                    </div>
                    <div class="form-group">
                    <div class="col-lg-offset-3 col-lg-9">
                        <div class="checkbox">
                        <label>
                            <input type="checkbox"> Remember me
                        </label>
                        </div>
                    </div>
                    </div>
                    <div class="form-group">
                    <div class="col-lg-offset-3 col-lg-7">
                        <button type="submit" class="btn btn-default" data-loading-text="Signing in...">Sign in</button>
                    </div>
                    </div>
                </form>
              
            </div> <!-- /col-md-5 -->
            
        </div> <!-- /container -->
    </script>
    
    <script type="text/template" id="dashboard-template">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#visits">RFK</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="<%=currentView == 'visit'?'active':''%>"><a id="visitTopNav" href="#visits"> Visits</a></li>
                    <li class="<%=currentView == 'manageMentors'?'active':''%>"><a id="mentorsTopNav" href="#mentors">Mentors</a></li>
                    <li class="<%=currentView == 'directorsPanel'?'active':''%>"><a id="directorsTopNav" href="#directors">Directors</a></li>
                </ul>
                <form class="navbar-form navbar-right">
                    <button type="button" class="btn btn-default" id="signoutButton">Sign out <i class="glyphicon glyphicon-log-out"></i></button>
                </form>
                    <p class="navbar-right navbar-text">Logged in as <%= currentUsername %> </p>
            </div>
        </nav>

        <div id="dashboardContainer">
        </div>
    </script>

    <script type="text/template" id="manage-mentors-template">
        <div id="manageMentorsContainer">
            <h1>Manage Mentors</h1>
            <table class="table table-striped" id="manageMentorsTable">
                <tr><th>Name</th><th>Username</th><th>Phone Number</th><th>Address</th><th>Photo</th>
                    <th>
                        <button type="button" value="Add User" name="mentorAdd" class="btn btn-success" id="addMentorToggle">
                            <i class="glyphicon glyphicon-plus"></i> <span>Add Mentor</span>
                        </button>
                    </th>
                </tr>
                
            </table>
        </div>
    </script>

    <script type="text/template" id="directors-panel-template">
        <div id="directorsPanelContainer">
            <h1>Directors Panel</h1>
            <table class="table table-striped" id="directorsPanelTable">
                
            </table>
        </div>
    </script>

    <script type="text/template" id="manage-mentor-row-template">
        <tr parsley-validate parsley-bind>
            <td>
                <% if(editMode){%>
                <input name="mentorName" type="text" value="<%=newForm?'':User.get('name')%>" placeholder="Name" class="form-control" />
                <%}else{%>
                <%=User.get('name')%>
                <%}%>
            </td>
            <td>
                <% if(editMode){%>
                <input name="mentorUsername" type="text" value="<%=newForm?'':User.get('username')%>" placeholder="Username" class="form-control" /> 
                <%}else{%>
                <%=User.get('username')%>
                <%}%>
            </td>
            <td>
                <% if(editMode){%>
                <input name="mentorPhone" type="text" value="<%=newForm?'':User.get('phone')%>" parsley-type="phone" placeholder="Phone" parsley-trigger="keyup" class="form-control" />
                <%}else{%>
                <%=User.get('phone')%>
                <%}%>
            </td>
            <td>
                <% if(editMode){%>
                <input name="mentorAddress" type="text" value="<%= newForm || User.get('Address') == undefined?'':User.get('Address').get('Address')!=undefined? User.get('Address').get('Address'):'' %>" placeholder="Address" class="form-control" />
                <input name="mentorAddress2" type="text" value="<%= newForm || User.get('Address') == undefined?'':User.get('Address').get('Address2')!=undefined? User.get('Address').get('Address2'):'' %>" placeholder="Address 2" class="form-control" />
                <input name="mentorCity" type="text" value="<%= newForm || User.get('Address') == undefined?'':User.get('Address').get('City')!=undefined? User.get('Address').get('City'):'' %>" placeholder="City" class="form-control" />
                <input name="mentorZipCode" type="text" value="<%= newForm || User.get('Address') == undefined?'':User.get('Address').get('Zip')!=undefined? User.get('Address').get('Zip'):'' %>" placeholder="Zip Code" class="form-control smallInput" />
                <input name="mentorState" type="text" value="<%= newForm || User.get('Address') == undefined?'':User.get('Address').get('State')!=undefined? User.get('Address').get('State'):'' %>" placeholder="State" class="form-control smallInput" />
                <%}else if(User.get('Address') != undefined){%>
                <address>
                    <%= User.get('Address').get('Address')!=undefined? User.get('Address').get('Address') + '<br/>':'' %>
                    <%= User.get('Address').get('Address2')!=undefined? User.get('Address').get('Address2') + '<br/>':'' %>
                    <%= User.get('Address').get('City')!=undefined? User.get('Address').get('City') + ',':'' %>
                    <%= User.get('Address').get('State') %>
                    <%= User.get('Address').get('Zip')!=undefined? User.get('Address').get('Zip') + '<br/>':'' %>
                </address>
                <%}else{%>
                No Address
                <%}%>
            </td>
            <td>
                <% if(editMode){%>
                <input type="file" value="Upload Photo" style="width:100%;"/>
                <%}else{%>
                <span class="smallProfilePicture" style="background-image:url('<%= User.get('Photo').url %>');"></span>
                <%}%>
            </td>
            <td>
                <%if(editMode){%>
                <button type="button" value="Add User" id="saveNewMentor" class="btn btn-success">
                    <i class="glyphicon glyphicon-ok-sign"></i> Save Mentor 
                </button>
                <%if(!newForm) {%>
                    <!-- this uses css transforms to change repeat into undo -->
                    <button type="button" class="btn btn-default cancel-edit-mentor" title="cancel"><i class="glyphicon glyphicon-repeat"></i></button>
                <%}%>
                <%}else{%>
                <button type="button" class="btn btn-default edit-mentor" title="edit"><i class="glyphicon glyphicon-pencil"></i></button>
                <button type="button" class="btn btn-default delete-mentor" title="delete"><i class="glyphicon glyphicon-remove"></i></button>
                <%}%>
            </td>
        </tr>
    </script>

    <script type="text/template" id="manage-mentor-row-template">
        <tr class="addAllMentors">
            <td><input name="mentorName" type="text" value="<%=User.get('name')%>" placeholder="Name" class="form-control" /></td>
            <td><%='Username'%></td>
            <td><%='Phone Number'%></td>
            <td><%='Address'%></td>
            <td><span class="smallProfilePicture" style="background-image:url('<%= User.get('Photo').url %>');"></span></td>
            <td>
                <button type="button" class="btn btn-default" title="edit"><i class="glyphicon glyphicon-pencil"></i></button>
                <button type="button" class="btn btn-default" title="delete"><i class="glyphicon glyphicon-remove"></i></button>
            </td>
        </tr>
    </script>



    <script type="text/template" id="visit-viewer-template">
        <div id="sidebar">
        </div>
        <div id="visit-wrapper" >
            <div id="visit">
                <span id="main-pane-welcome"><span style="font-size:.8em" class="glyphicon glyphicon-arrow-left"></span> Select a visit</span>
            </div>
        </div>
    </script>

    <script type="text/template" id="side-bar-template">
        <form id="mentorlistfilter" action="#">
            <div class="input-group">
              <span class="input-group-addon glyphicon glyphicon-search"></span>
              <input class="form-control" type="text" placeholder="Filter Mentors..." id="searchInput">
            </div>
        </form>
        <ul id="mentor-list">
            Loading Mentor List...
        </ul>
        <div class="clear-fix"/>
    </script>
    
    <script type="text/template" id="mentor-item-template">
        <li class="mentor">
            <div class="mentor-name">
            <span class="smallProfilePicture" style="background-image:url('<%= User.get('Photo').url %>');"></span>
            <%= User.get('name') %></div>
            <ul class="visit-list">
                loading visits...
            </ul>
        </li>
    </script>
    
    <script type="text/template" id="visit-item-template">
        <li class="li-visit"><%= Name %></li>
    </script>
    
    <script type="text/template" id="visit-template">
        <h1><%= Name %></h1>
        <div class="visit-info">
            On <b><%= Start.format('MMMM Do YYYY') %></b>
            at <b><%= Start.format('h:mm a') %></b>,
            <b><%= Mentor.get('User').get('name') %></b> visited 
            <%= getKidListString(Kids, 'FirstName')%>
            for <b><%= moment.duration(End.diff(Start)).humanize()%></b>.
        </div>
        <div id="map">
        </div>
        <div id="visitLog">
        </div>
    </script>
    
    <script type="text/template" id="map-template">
        <div>
            Map Load Error.
        </div>
    </script>

    <script type="text/template" id="loglist-template">
        <h1 class="text-center">Comments &amp; Photos</h1>
        <ul id="logitem-list">
        </ul>
    </script>

    <script type="text/template" id="comment-template">
        <li>
            <div class="visitComment">
                <span><b><%= createdAt.format('MMMM Do YYYY h:mm a')%></b></span>
                <p><%= Text %><p>
            </div>
        </li>
    </script>

     <script type="text/template" id="photo-template">
        <li>            
            <div class="visitPhoto" >
               <span><%= createdAt.format('MMMM Do YYYY h:mm a')%></span>

                    <!--This link points to an exact index, needs to be fixed -->

                    <a href="#<%=id%>" data-toggle="lightbox">
                        <img class="thumbnail" src="<%= Data.url %>" />
                    </a>
            </div>
            <div id="<%=id%>" class="lightbox fade"  tabindex="-1" role="dialog" aria-hidden="true">
                <div class='lightbox-dialog'>
                    <div class='lightbox-content'>
                        <img src=<%= Data.url %> style="max-width:100%;height:auto;" />
                    </div>
                </div>
            </div
        </li>
    </script>
  </body>

</html>
